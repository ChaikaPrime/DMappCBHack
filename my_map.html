<!DOCTYPE html>
<html>
<head>
	
<title>My super map</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
   integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
   crossorigin=""/>
   
    <!-- Make sure you put this AFTER Leaflet's CSS -->
<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
   integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
   crossorigin=""></script>
 
<div id="mapid" style="width: 100%; height: 600px;"></div>

<input type="file" id="file-input" onchange="readJSONFile(this)" />
<h3>Contents of the file:</h3>
<pre id="file-content"></pre>

<script>
	var mymap = L.map('mapid');
	mymap.setView([51.5, -0.09], 13);

	L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox.streets'
	}).addTo(mymap);

	//var london_marker = L.marker([51.5, -0.09]);
	//london_marker.addTo(mymap);
	//london_marker.bindPopup("<b>Hello world!</b><br />I am a popup.");
	//london_marker.openPopup();

	var station_names = [
		"NEW OXFORD STREET",
		"MUSEUM STREET",
		"HOLBORN STATION",
		"ALDWYCH / THE ROYAL COURTS OF JUSTICE",
		"ALDWYCH / SOMERSET HOUSE",
		"WATERLOO BRIDGE / SOUTH BANK",
		"WATERLOO STATION / WATERLOO ROAD",
		"THE OLD VIC",
		"ST GEORGE'S CIRCUS",
		"ELEPHANT & CASTLE / LONDON ROAD",
		"ELEPHANT & CASTLE / NEW KENT ROAD",
		"RODNEY PLACE",
		"BRICKLAYER'S ARMS / NEW KENT ROAD",
		"BRICKLAYER'S ARMS / TOWER BRIDGE ROAD",
		"GRIGGS PLACE",
		"FENDALL STREET",
		"SPA ROAD",
		"ALSCOT ROAD",
		"HARRIS ACADEMY",
		"SOUTHWARK PARK ROAD / ST JAMES'S ROAD",
		"ANCHOR STREET",
		"LYNTON ROAD",
		"GALLEYWALL ROAD / SOUTH BERMONDSEY STN",
		"BEAMISH HOUSE",
		"CORBETTS LANE / THE JOLLY GARDENERS",
		"WARNDON STREET",
		"SURREY QUAYS STATION",
		"ROTHERHITHE POLICE STATION",
		"CANADA WATER BUS STATION"
	]

	plotPath();

	//var popup = L.popup();

	/*function onMapClick(e) {
		popup
			.setLatLng(e.latlng)
			.setContent("You clicked the map at " + e.latlng.toString())
			.openOn(mymap);
	}
	mymap.on('click', onMapClick);
*/

	function plotPath() {
		var client = new XMLHttpRequest();
		client.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				content = this.responseText;
				var parsedcontent = JSON.parse(content);
        console.log(parsedcontent.tower_to_wapping.coordinates);
				var latlngs = parsedcontent.tower_to_wapping.coordinates;

				var polyline = L.polyline(latlngs, {color: 'red'}).addTo(mymap);
				polyline.bindPopup("I am a polyline.");
				// zoom the map to the polyline
				//map.fitBounds(polyline.getBounds());

				var i;
				for (i = 0; i < latlngs.length; i++) { 
					L.circle(latlngs[i], 50, {
						color: 'red',
						fillColor: '#f03',
						fillOpacity: 0.5
					}).addTo(mymap).bindPopup(station_names[i]);;
				}
       }
		}
		client.open('GET', '/path.json', true);
		client.send();
	}

</script>
</body>
</html>




